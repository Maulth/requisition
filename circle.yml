machine:
  environment:
    RAILS_ENV: test
    RACK_ENV: test

dependencies:
  bundler:
    without: [production, development]
  post:
    - rake assets:precompile

test:
  override:
    - bundle exec rake test TESTOPTS="--ci-dir=$CIRCLE_TEST_REPORTS":
        parallel: true
        files:
          - test/**/*_test.rb
  post:
    - bundle exec rubocop --rails --fail-level=warning --display-cop-names --format=progress --format=offenses --format=html --out="$CIRCLE_ARTIFACTS/rubocop.html"
    - bundle exec rake coverage:notify
